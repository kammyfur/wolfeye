<%

if (typeof get["q"] !== "undefined") {
    query = get["q"].toLowerCase().substr(0, 200).replace(/[^A-Za-z0-9 ]/, '').replace(/[\.]/, ' ').trim();
} else {
    res.writeHead(301, {"Location": "/" + slang});
    res.end();
}

if (query === "") {
    res.writeHead(301, {"Location": "/" + slang});
    res.end();
}

if (fs.existsSync(wwwdata + "/../../data/instants/" + query.replaceAll(" ", "_"))) {
    data = fs.readFileSync(wwwdata + "/../../data/instants/" + query.replaceAll(" ", "_"), 'utf-8');
} else {
    data = "{\"Abstract\":\"\",\"AbstractText\":\"\"}";
}

res.writeHead(200, {'Content-Type': 'application/json; charset=utf-8'});

 %><%- data %>